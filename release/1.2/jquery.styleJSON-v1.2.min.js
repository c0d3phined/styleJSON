/* 
 * styleJSON - version 1.2
 * MIT License
 * 2011 Daniel Brooks
 */
(function(d){if(!Object.keys)Object.keys=function(c){if(c!==Object(c))throw new TypeError("Object.keys called on non-object");var d=[],l;for(l in c)Object.prototype.hasOwnProperty.call(c,l)&&d.push(l);return d};Date.fromJSONDate=function(c){return eval(c.replace(/\/Date\((-?\d+)\)\//gi,"new Date($1)"))};d.styleJSON=function(c,q,l){return d.fn.styleJSON(c,q,l)};d.styleJSON.defaults={arrayTag:"ul",useDateFormat:true,dateFormatPath:"js/date.format.js",dateFormat:"dddd, mmmm d, yyyy"};d.fn.styleJSON=
function(c,q,l){function u(a,b){return b?document.createElement(a):d(document.createElement(a))}function A(a,b){for(var h=a.split("."),c=h.length,d=b,i=0;i<c;i++)d.hasOwnProperty(h[i])&&(d=d[h[i]]);return d==b?null:d}function B(a,b,h){var d=h?h:b.parent(),a=h?!a?0:a.length:a.length-1;for(x=0;x<a;x++)b.clone().appendTo(d)}function w(a,b){try{a=Date.fromJSONDate(a),isDate=true,y.useDateFormat&&typeof dateFormat=="function"?a=dateFormat(a,y.dateFormat):d.getScript(y.dateFormatPath,function(){a=dateFormat(a,
y.dateFormat);b.text(a)})}catch(h){console&&console.log&&console.log("error parsing Date string.")}}function t(a,b,h){J.call(a);if(typeof a=="object")for(var c=Object.keys(a),r=0;r<c.length;r++){if(!(c[r]=="types"||c[r]=="hasKey")){var i=null,e=false,i=a.key,m=c[r];if(d.isArray(b)&&!d.isArray(a)){c=b.length;for(r=0;r<c;r++)i=h.children("li").eq(r),i.length?t(a,b[r],i):/ul|ol|li/gi.test(m);break}else if(d.isArray(a)){m=a.length;for(c=0;c<m;c++)t(a[c],b,h);break}a:{var e=m,f=a,s=h,k=b;if(e=="key")e=
void 0;else{for(var o=K,j=null,l=f.key,g=void 0,j=0;j<o.length;j++)if(e==o[j]){j=u(e);if(typeof f[e]=="string")if(f.hasKey)/ul|ol|li/gi.test(e)&&(k=A(l,k),B(k,u(e),s),t(f[e],k,s));else{g=k[f[e]]?k[f[e]]:"";z(g)&&w(g,j);if(f[e].split(" ").length>1){for(var n=f[e].split(" "),q=n.length,p=0;p<q;p++)j.addClass(n[p]),g=k[n[p]]?k[n[p]]:g,z(g)&&w(g,j);j.appendTo(s)}else j.addClass(f[e]).appendTo(s);C(g)?j.html(g):j.text(g)}else if(d.isArray(f[e])){f=f[e];for(o=0;o<f.length;o++)if(f[o].split(" ").length>
1){n=f[o].split(" ");q=n.length;for(p=0;p<q;p++)j.addClass(n[p]),g=k[n[p]]?k[n[p]]:"",z(g)&&w(g,j);j.appendTo(s)}else g=k[f[o]]?k[f[o]]:k[l]&&k[l][f[o]]?k[l][f[o]]:"",n=u(e),n.addClass(f[o]).appendTo(s),z(g)?w(g,n):C(g)?n.html(g):n.text(g)}else typeof f[e]=="object"&&(j.appendTo(s),f.hasKey&&(s=A(l,k),B(s,j)),t(f[e],k,j));e=true;break a}e=false}}e||m=="key"||(typeof a[m]=="string"?(i=b[a[m]]?b[a[m]]:"",h.addClass(a[m]),C(i)?h.html(i):h.text(i)):a[m]!=null&&typeof a[m]=="object"&&(e=u("div"),e.addClass(m).appendTo(h),
a.hasKey&&(i=A(i,b),d.isArray(i)&&(b=i,e.remove(),e=u("ul"),e.addClass(m).appendTo(h)),B(i,u("li"),e)),t(a[m],b,e)))}}else typeof a=="string"&&h.addClass(a)}function D(a,b){return d.isArray(a)?{data:{items:a},template:b.key?b:{key:"items",items:b}}:{data:a,template:b}}function F(a,b){G-1==E&&H&&(E=0,H.call(a,a,b));E++}var J=function(){var a;if(this.hasOwnProperty("hasKey")&&this.hasOwnProperty("types"))a=this;else{a={types:[],hasKey:false};for(var b in this){if(b=="key")a.hasKey=true;a.types.push(typeof this[b])}}for(var c in a)this.hasOwnProperty(c)||
(this[c]=a[c]);return this},y=d.styleJSON.defaults||{},K="div,span,h1,h2,h3,section,ul,ol,li,p,i,b,label".split(",");"ol,ul".split(",");var C=function(a){return/<a[^>]*>(.*?)<\/a>/gi.test(a)},v=null,E=0,H=typeof l=="function"?l:jQuery.noop,G=this.length?this.length:false,I=this,z=function(a){return/Date\(\d*\)/g.test(a)};return!G?d("body").style(c,q):this.each(function(){var a=d(this),b={};typeof c=="string"&&v==null?d.getJSON(c,function(d){v=c=d;b=D(v,q);t(b.template,b.data,a)}).error(function(d){d.responseText?
(c=v=eval("("+d.responseText+")"),typeof c=="object"&&(b=D(c,q)),t(b.template,b.data,a)):console&&console.log&&console.log("An error occured.")}).complete(function(){F(I,c)}):typeof c=="object"&&(b=D(v=c,q),t(b.template,b.data,a),F(I,c))})}})(window.jQuery,void 0);
